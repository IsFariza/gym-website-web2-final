<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>PinkPower | –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="profile-page">

<header class="header">
  <div class="logo">PinkPower üíó</div>
  <nav>
    <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="exercises.html">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</a>
    <a href="#" onclick="logout()" class="logout-btn">–í—ã–π—Ç–∏</a>
  </nav>
</header>

<aside class="sidebar">
  <div class="profile-intro">
    <div class="avatar-container">
      <img src="https://via.placeholder.com/130/ff69b4/ffffff?text=Pink" class="profile-pic" alt="Avatar">
      <button class="btn-add-profile">+</button>
    </div>
    <h2 class="username-title" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
    <p class="user-role" id="userRole">loading...</p>
  </div>

  <div class="user-info-box">
    <p><strong>Email:</strong> <span id="userEmail">-</span></p>
    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="userPhone">-</span></p>
  </div>
</aside>

<main class="main-content">
  <h3 class="section-label">–ú–æ–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
  
  <div id="workoutsContainer" class="workouts-list">
    <p class="loading-text">–ò—â–µ–º –≤–∞—à–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è... ‚ú®</p>
  </div>
</main>

<script>
    // 1. –§—É–Ω–∫—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    const getAuthHeaders = () => {
        const token = localStorage.getItem('token');
        return {
            'Authorization': token, 
            'Content-Type': 'application/json'
        };
    };

    // 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function loadUserInfo() {
        try {
            const res = await fetch('http://localhost:5000/api/profile', { 
                headers: getAuthHeaders() 
            });

            if (!res.ok) {
                console.log("–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:", res.status);
                // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≥–æ–≤–æ—Ä–∏—Ç "–Ω–µ–ª—å–∑—è", —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ:
                // window.location.href = 'login.html'; 
                return;
            }

            const user = await res.json();
            
            if(document.getElementById('userName')) document.getElementById('userName').innerText = user.username;
            if(document.getElementById('userEmail')) document.getElementById('userEmail').innerText = user.email;
            if(document.getElementById('userPhone')) document.getElementById('userPhone').innerText = user.phoneNumber || '–ù–µ —É–∫–∞–∑–∞–Ω';
            if(document.getElementById('userRole')) document.getElementById('userRole').innerText = user.role;
            
        } catch (err) {
            console.error("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:", err);
        }
    }

    // 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    function toggleEditForm() {
        alert("–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–≤–æ–µ–≥–æ Pink-–ø—Ä–æ—Ñ–∏–ª—è! üíó");
    }

    function logout() {
        localStorage.removeItem('token');
        window.location.href = 'login.html';
    }

    // 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    document.addEventListener('DOMContentLoaded', () => {
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = 'login.html';
        } else {
            loadUserInfo();
        }
    });
  </script>
</script>
</body>
</html>